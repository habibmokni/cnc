@if (!isStoreSelected()) {
  <div class="maps-container">
    <google-map
      [options]="options()"
      [height]="mapHeight()"
      [width]="mapWidth()">
      <map-marker [position]="currentLocation()" [options]="markerOptions" />

      @for (store of storeList(); track store.id; let i = $index) {
        <map-marker
          #marker="mapMarker"
          [position]="storeLocations()[i]"
          [options]="markerOptions"
          (mapClick)="openInfoWindow(marker, store, $event)" />
      }

      @if (currentStore(); as cs) {
        <map-info-window #infoWindow="mapInfoWindow">
          <h2>{{ cs.name }}</h2>
          <p>{{ cs.address }}</p>
          <button mat-flat-button type="button" (click)="onStoreSelect(cs)">Select</button>
          <button mat-flat-button type="button" (click)="onGetDirections(cs.location)">Directions</button>
        </map-info-window>
      }

      <map-marker [position]="currentUserLocation()" />

      @if (directionsResult(); as dr) {
        <map-directions-renderer [directions]="dr" />
      }
    </google-map>

    <button mat-flat-button class="cnc-btn" (click)="onGetCurrentLocation()">
      <mat-icon>my_location</mat-icon> Stores Nearby
    </button>
  </div>
}

@if (isStoreSelected()) {
  <div class="maps-container">
    <button mat-flat-button class="cnc-btn" (click)="reselectStore()">Change store</button>
  </div>
}
